/* v 3.3.0
author http://codecanyon.net/user/creativeinteractivemedia/portfolio?ref=creativeinteractivemedia
*/
var FLIPBOOK=FLIPBOOK||{};FLIPBOOK.BookSwipe=function(i,e,t,s){this.options=s,this.singlePage=s.singlePageMode,this.pageWidth=this.options.pageWidth,this.pageHeight=this.options.pageHeight,this.slides=[],this.pagesArr=[],this.leftPage=0,this.rightPage=0,this.prevPageEnabled=!1,this.setRightIndex(0),this.currentSlide=0,this.flipping=!1,this.wrapper=e,this.$wrapper=jQuery(e),this.scroller=i,this.$scroller=jQuery(this.scroller).removeClass("book").addClass("flipbook-carousel-scroller"),this.iscroll=new IScroll(this.wrapper,{snap:!0,snapSpeed:200,scrollX:!0,scrollY:!1});for(var h=0;h<3;h++){var n=jQuery('<div><div class="slide-inner"/></div>"').appendTo(this.$scroller).addClass("flipbook-carousel-slide");this.slides.push(n)}var r,o=this.slides[1];o.iscroll=new IScroll(o[0],{scrollbars:!0,zoomMin:1,zoom:1,scrollX:!0,scrollY:!0,freeScroll:!0}),o.iscroll.refresh(),o.iscroll.on("zoomEnd",function(){if(this.scale>1){l.getCurrentSlidePages();l.disableFlip()}else l.slides[l.getCurrentSlide()].width(l.$wrapper.width()).height(l.$wrapper.height()),l.onResize(),l.enableFlip()}),o.iscroll.on("zoomStart",function(){l.iscroll.disable()});for(s.rightToLeft,s.numPages,s.pdfMode,h=0;h<s.numPages;h++)r=new FLIPBOOK.PageSwipe(s,h,s.pages[h].src,s.pages[h].htmlContent),this.pagesArr.push(r),s.loadAllPages&&r.load();var l=this;this.iscroll.on("scrollEnd",function(){var i=this.currentPage.pageX;if(1==i)return l.flipping=!1,void l.updateVisiblePages();l.singlePage?i>l.currentSlide?l.setRightIndex(l.rightIndex+1):i<l.currentSlide&&l.setRightIndex(l.rightIndex-1):i>l.currentSlide?l.setRightIndex(l.rightIndex+2):i<l.currentSlide&&l.setRightIndex(l.rightIndex-2),l.currentSlide=i,l.updateVisiblePages(),l.flipping=!1}),this.flipEnabled=!0,this.nextEnabled=!0,this.prevEnabled=!0},FLIPBOOK.BookSwipe.prototype.constructor=FLIPBOOK.BookSwipe,FLIPBOOK.BookSwipe.prototype={goToPage:function(i,e){if(this.enabled&&this.flipEnabled){if((isNaN(i)||i<1)&&(i=1),i>this.pagesArr.length&&(i=this.pagesArr.length),this.singlePage?i--:i%2!=0&&i--,this.resetZoom(),e)return this.setRightIndex(i),void this.updateVisiblePages();this.singlePage?(this.options.rightToLeft&&this.options.oddPages&&i<1&&(i=1),i>this.rightIndex?(this.setSlidePages(this.currentSlide+1,[i]),this.setRightIndex(i-1),this.nextPage(e)):i<this.rightIndex&&(this.setSlidePages(this.currentSlide-1,[i]),this.setRightIndex(i+1),this.prevPage(e))):(this.options.rightToLeft&&this.options.oddPages&&i<2&&(i=2),i>this.rightIndex?i>=this.pagesArr.length?(this.setSlidePages(2,[i-1,i]),this.setRightIndex(i-2),this.goToSlide(2,e)):(this.setSlidePages(this.currentSlide+1,[i-1,i]),this.setRightIndex(i-2),this.nextPage(e)):i<this.rightIndex&&(0==i?(this.setRightIndex(i+2),this.setSlidePages(0,[i]),this.goToSlide(0,e)):(this.setRightIndex(i+2),this.setSlidePages(this.currentSlide-1,[i-1,i]),this.prevPage(e))))}},setRightIndex:function(i){this.rightIndex=i},nextPage:function(i){this.flipEnabled&&2!=this.currentSlide&&(this.flipping=!0,this.goToSlide(this.currentSlide+1,i))},prevPage:function(i){this.flipEnabled&&0!=this.currentSlide&&(this.flipping=!0,this.goToSlide(this.currentSlide-1,i))},enablePrev:function(i){this.prevEnabled=i},enableNext:function(i){this.nextEnabled=i},resetZoom:function(){1!==this.slides[1].iscroll.scale&&this.slides[1].iscroll.zoom(1,0,0,0),this.slides[1].iscroll.refresh(),this.iscroll.enable()},setSlidePage:function(i,e){},setSlidePages:function(i,e){this.clearSlidePages(i);for(var t=0;t<e.length;t++){var s=e[t];this.pagesArr[s]&&(this.slides[i].find(".slide-inner").append(this.pagesArr[s].$wrapper),this.slides[i].pages.push(s))}},clearSlidePages:function(i){this.slides[i].find(".slide-inner").empty(),this.slides[i].pages=[]},setZoomPages:function(i){if(!this.$zoomScroller.pages||this.$zoomScroller.pages.join("")!=i.join("")){this.$zoomScroller.empty(),this.$zoomScroller.pages=[];for(var e=0;e<i.length;e++){var t=i[e];this.pagesArr[t]&&(this.$zoomScroller.append(this.pagesArr[t].$wrapper),this.$zoomScroller.pages.push(t))}}},resizeZoomPages:function(i,e){var t=this.$wrapper.height()*e,s=500*parseInt(t/500)+500;s<500&&(s=500),s>2e3&&(s=2e3);for(var h=0;h<i.length;h++){var n=i[h];this.pagesArr[n]&&this.pagesArr[n].load()}},getCurrentSlidePages:function(){return this.singlePage?[this.rightIndex]:[this.rightIndex-1,this.rightIndex]},clearSlide:function(i){this.slides[i].empty()},hasPage:function(i,e){},updateVisiblePages:function(){this.singlePage?0==this.rightIndex?(this.setSlidePages(1,[0]),this.setSlidePages(2,[1]),this.clearSlidePages(0),this.iscroll.prevDisabled=!0,this.iscroll.nextDisabled=!1):this.options.rightToLeft&&1==this.rightIndex&&this.options.oddPages?(this.setSlidePages(1,[1]),this.setSlidePages(2,[2]),this.clearSlidePages(0),this.iscroll.prevDisabled=!1,this.iscroll.nextDisabled=!0):this.options.rightToLeft&&this.rightIndex==this.options.numPages-1&&this.options.oddPages?(this.setSlidePages(1,[this.rightIndex]),this.setSlidePages(0,[this.rightIndex-1]),this.setSlidePages(2,[this.rightIndex+1]),this.iscroll.prevDisabled=!1,this.iscroll.nextDisabled=!1):this.rightIndex==this.options.numPages-1?(this.setSlidePages(1,[this.rightIndex]),this.setSlidePages(0,[this.rightIndex-1]),this.clearSlidePages(2),this.iscroll.prevDisabled=!1,this.iscroll.nextDisabled=!0):(this.setSlidePages(1,[this.rightIndex]),this.setSlidePages(0,[this.rightIndex-1]),this.setSlidePages(2,[this.rightIndex+1]),this.iscroll.prevDisabled=!1,this.iscroll.nextDisabled=!1):0==this.rightIndex?(this.setSlidePages(1,[0]),this.setSlidePages(2,[1,2]),this.clearSlidePages(0),this.iscroll.prevDisabled=!0,this.iscroll.nextDisabled=!1):this.options.rightToLeft&&2==this.rightIndex&&this.options.oddPages?(this.setSlidePages(1,[1,2]),this.setSlidePages(2,[3,4]),this.clearSlidePages(0),this.iscroll.prevDisabled=!0,this.iscroll.nextDisabled=!1):this.options.rightToLeft&&this.rightIndex==this.options.numPages-1&&this.options.oddPages?(this.setSlidePages(1,[this.rightIndex-1,this.rightIndex]),this.setSlidePages(0,[this.rightIndex-3,this.rightIndex-2]),this.setSlidePages(2,[this.rightIndex+1,this.rightIndex+2]),this.iscroll.prevDisabled=!1,this.iscroll.nextDisabled=!1):this.rightIndex>=this.options.numPages-1?(this.setSlidePages(1,[this.rightIndex-1,this.rightIndex]),this.setSlidePages(0,[this.rightIndex-3,this.rightIndex-2]),this.clearSlidePages(2),this.iscroll.prevDisabled=!1,this.iscroll.nextDisabled=!0):(this.setSlidePages(1,[this.rightIndex-1,this.rightIndex]),this.setSlidePages(0,[this.rightIndex-3,this.rightIndex-2]),this.setSlidePages(2,[this.rightIndex+1,this.rightIndex+2]),this.iscroll.prevDisabled=!1,this.iscroll.nextDisabled=!1),this.loadVisiblePages(),this.goToSlide(1,!0),this.options.main.turnPageComplete()},loadPage:function(i){this.pagesArr[i]&&this.pagesArr[i].load()},loadVisiblePages:function(){var i=this.options.main;if(this.singlePage){var e=this.pagesArr[this.rightIndex],t=this.pagesArr[this.rightIndex+1],s=this.pagesArr[this.rightIndex-1];e&&e.load(function(){i.setLoadingProgress(1),t&&t.load(),s&&s.load()})}else{var h=this.pagesArr[this.rightIndex],n=this.pagesArr[this.rightIndex-1],r=(t=this.pagesArr[this.rightIndex+1],this.pagesArr[this.rightIndex+2]),o=(s=this.pagesArr[this.rightIndex-2],this.pagesArr[this.rightIndex-3]);n?n.load(function(){h?h.load(function(){i.setLoadingProgress(1),s&&s.load(),o&&o.load(),t&&t.load(),r&&r.load()}):(i.setLoadingProgress(1),s&&s.load(),o&&o.load())}):h&&h.load(function(){i.setLoadingProgress(1),t&&t.load(),r&&r.load()})}},hidePage:function(i){},showPage:function(i){},disable:function(){this.enabled=!1},enable:function(){this.enabled=!0,this.onResize()},resize:function(){},onResize:function(){for(var i=this.$wrapper.width(),e=this.$wrapper.height(),t=0;t<this.slides.length;t++)this.slides[t].width(i).height(e);this.slides[1].iscroll.refresh();var s=500*parseInt(e/500)+500;s<500&&(s=500),s>2e3&&(s=2e3),this.$scroller.width(this.$scroller.children().length*i),this.iscroll.refresh();var h,n,r=2*this.pageWidth/this.pageHeight>i/e;this.pageWidth/this.pageHeight>i/e?(h=i,n=parseInt(i*this.pageHeight/this.pageWidth)):(n=e,h=parseInt(e*this.pageWidth/this.pageHeight));for(t=0;t<this.pagesArr.length;t++)this.pagesArr[t].setSize(h,n),this.pagesArr[t].$wrapper.css("top",String((e-n)/2)+"px");r&&!this.singlePage?(this.rightIndex%2==0&&this.rightIndex>0&&this.setRightIndex(this.rightIndex-1),this.singlePage=!0):!r&&this.singlePage&&(this.rightIndex%2!=0&&this.setRightIndex(this.rightIndex+1),this.singlePage=!1),this.updateVisiblePages()},goToSlide:function(i,e){var t=e?0:300*this.options.pageFlipDuration;this.iscroll.pages.length>0&&this.iscroll.goToPage(i,0,t),e&&(this.currentSlide=i)},getCurrentSlide:function(){return this.currentSlide},zoomIn:function(i,e,t){t&&"mousewheel"===t.type||this.zoomTo(i)},zoomTo:function(i,e,t,s){if(this.enabled){t=t||0,s=s||0,e=e||0;i>1&&this.iscroll.disable(),this.slides[this.currentSlide].iscroll&&this.slides[this.currentSlide].iscroll.zoom(i,t,s,e)}},zoomOut:function(i){this.zoomTo(i)},onZoom:function(){},enableAutoplay:function(i){},updateCurrentPage:function(i){},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},onSwipe:function(i,e,t,s,h,n,r){},onPageLoaded:function(i,e){var t=this.options.rightToLeft?this.options.numPages-i-1:i;this.pagesArr[t].onPageLoaded(e,this.options.pages[i].canvas[e],this.options.pages[i].htmlContent)},onPageUnloaded:function(i,e){var t=this.options.rightToLeft?this.options.numPages-i-1:i;this.pagesArr[t].onPageUnloaded(e)},disableFlip:function(){this.flipEnabled=!1,this.iscroll.disable()},enableFlip:function(){this.flipEnabled=!0,this.iscroll.enable()}},FLIPBOOK.PageSwipe=function(i,e,t,s){this.index=e,this.options=i,this.texture=t,this.html=s,this.index=e,this.$wrapper=jQuery("<div>").addClass("flipbook-carousel-page"),this.wrapper=this.$wrapper[0],this.$inner=jQuery("<div>").appendTo(this.$wrapper).addClass("flipbook-carousel-page-inner"),this.$img=jQuery("<img>")},FLIPBOOK.PageSwipe.prototype={load:function(i){if(!this.loaded){this.loaded=!0;var e=this.options.rightToLeft?this.options.numPages-this.index-1:this.index;if(this.options.pdfMode)this.pageSize!=this.options.pageTextureSize?this.options.main.loadPage(e,this.options.pageTextureSize,i):i&&i.call(this);else{var t=this;this.options.main.loadPage(e,this.options.pageTextureSize,function(e){var s=document.createElement("img");s.src=e.image.src,t.$img=jQuery(s);e.image.naturalHeight;var h=e.image.naturalHeight;t.options.pageWidth,t.options.pageHeight;t.$img.appendTo(t.$inner),t.options.doublePage&&t.index>0&&t.index%2==0&&t.$img.css("left","-100%"),t.options.doublePage?0==t.index||t.index==t.options.pages.length-1&&!t.options.oddPages?t.$img.css("width","100%"):t.$img.css("width","200%"):t.$img.css("width","100%"),e.htmlContent&&(t.htmlContent=e.htmlContent[0],e.htmlContent.appendTo(t.$inner),t.updateHtmlContentSize()),t.$wrapper.css("background","none"),i&&i.call(t)})}}},onPageLoaded:function(i,e,t){this.pageSize!=i&&(this.pageSize=i,this.$inner.empty(),jQuery(e).appendTo(this.$inner),jQuery(t).appendTo(this.$inner),this.htmlContent=t,this.updateHtmlContentSize())},onPageUnloaded:function(i){i==this.pageSize&&(this.$inner.empty(),this.pageSize=0)},dispose:function(){this.pageSize&&(this.pageSize=null,this.$inner.empty())},setSize:function(i,e){this.width=i,this.height=e,this.$wrapper.width(i).height(e),this.updateHtmlContentSize()},updateHtmlContentSize:function(){var i=this.height/1e3;this.htmlContent&&this.htmlContent.style&&(this.htmlContent.style.transform="scale("+i+")")}},FLIPBOOK.SlideSwipe=function(){},FLIPBOOK.SlideSwipe.constructor=FLIPBOOK.SlideSwipe,FLIPBOOK.SlideSwipe.prototype={clear:function(){}};